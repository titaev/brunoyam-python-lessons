# Обработка исключений, паттерны проектирования
## 1. Понятие исключения
Исключения (exceptions) - ещё один тип данных в python. Исключения необходимы для того, чтобы
сообщать программисту об ошибках.
## 2. Выброс и перехват исключения
Попробуем вызвать исключение
```python3
print(100 / 0)
```
Получим следующее
```python3
Traceback (most recent call last):
  File "", line 1, in
    print(100 / 0)
ZeroDivisionError: division by zero
```
Разберём это сообщение подробнее:
* интерпретатор нам сообщает о том, что он поймал исключение и напечатал информацию (Traceback (most
recent call last)).
* далее имя файла (File ""). Имя пустое, потому что мы находимся в интерактивном режиме, строка в
файле (line 1);
* выражение, в котором произошла ошибка (100 / 0).
* название исключения (ZeroDivisionError) и краткое описание исключения (division by zero).
Разумеется, возможны и другие исключения:
```python3
print(2 + '1')
```
Исключение:
```python3
Traceback (most recent call last):
  File "", line 1, in
    print(2 + '1')
TypeError: unsupported operand type(s) for +: 'int' and 'str'
```
```python3
int('qwerty')
```
Исключение:
```python3
Traceback (most recent call last):
  File "", line 1, in
    int('qwerty')
ValueError: invalid literal for int() with base 10: 'qwerty'
```
### Как работает выброс исключения?
Например, мы имеем файл **main.py**, в котором запускаем код
```python3
# main.py
from calc import div

result = div(100, 0)
print(result)
```
Имеем также файл **calc.py** в этом же пакете
```python3
# calc.py
def div(a, b):
    return a / b
```
При запуске файла **main.py** получим ошибку **ZeroDivisionError**. Сначала она появляется в третьей
строке файла **calc.py**, потом она поднимается по стеку вызова вверх и оказывается на 4 строке
файла **main.py**.
Попробуем перехватить исключение в каждом месте, где появляется возможность его перехватить. Для
перехвата исключения используется конструкция `try ... except ... [finally] ...`
Попробуем перехватить его на самом высоком уровне - в файле **main.py**
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except:
    print("Получилась ошибка какая-то")
print(result)
```
Если в блоке, который находится под **try** - происходит ошибка, то она перехватывается и
выполняется действие в блоке **except**. Отлов всех исключений считается плохой практикой, так как
мы можем не узнать об исключениях, которые могли произойти благодаря ошибками в коде или неожиданным
последствиям, которые мы не предусмотрели, поэтому всегда рекомендуется указывать класс исключения,
который мы собираемся отлавливать
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except ZeroDivisionError:
    print("Ошибка деления на ноль произошла")
print(result)
```
Если мы хотим не просто отловить ошибку, а получить и сам объект исключения, то его можно явно
указать в блоке except
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except ZeroDivisionError as e:
    print("Вот такая ошибка деления произошла:", e)
print(result)
```
Иногда нам нужно перехватывать больше чем одно исключение и выполнять для них одинаковые действия
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except (ZeroDivisionError, KeyError) as e:
    print("Ошибка деления или ошибка обращения по ключу. Вот она:", e)
print(result)
```
Если при перехвате разных ошибок нужно выполнять разные действия:
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except ZeroDivisionError as e:
    print("Вот такая ошибка деления произошла", e)
except KeyError as e:
    print("Вот такая ошибка обращения по ключу произошла:", e)
print(result)
```
Также в конструкцию перехвата исключений можно добавить блок finally - он выполняется всегда, в
независимости от того, было ли поймано исключение или нет
```python3
# main.py
from calc import div

try:
    result = div(100, 0)
    print("Расчёт проведён успешно")
except ZeroDivisionError as e:
    print("Вот такая ошибка деления произошла", e)
except KeyError as e:
    print("Вот такая ошибка обращения по ключу произошла:", e)
finally:
    print("Выполнение расчёта закончено")
print(result)
```
## 3. Стандартные исключения
* BaseException - базовое исключение, от которого берут начало все остальные.
* * SystemExit - исключение, порождаемое функцией sys.exit при выходе из программы.
* * KeyboardInterrupt - порождается при прерывании программы пользователем (обычно сочетанием клавиш
Ctrl+C).
* * GeneratorExit - порождается при вызове метода close объекта generator.
* * Exception - а вот тут уже заканчиваются полностью системные исключения (которые лучше не
трогать) и начинаются обыкновенные, с которыми можно работать.
* * * StopIteration - порождается встроенной функцией next, если в итераторе больше нет элементов.
* * * ArithmeticError - арифметическая ошибка.
* * * * FloatingPointError - порождается при неудачном выполнении операции с плавающей запятой. На
практике встречается нечасто.
* * * * OverflowError - возникает, когда результат арифметической операции слишком велик для
представления. Не появляется при обычной работе с целыми числами (так как python поддерживает
длинные числа), но может возникать в некоторых других случаях.
* * * * ZeroDivisionError - деление на ноль.
* * * AssertionError - выражение в функции assert ложно.
* * * AttributeError - объект не имеет данного атрибута (значения или метода).
* * * BufferError - операция, связанная с буфером, не может быть выполнена.
* * * EOFError - функция наткнулась на конец файла и не смогла прочитать то, что хотела.
* * * ImportError - не удалось импортирование модуля или его атрибута.
* * * LookupError - некорректный индекс или ключ.
* * * * IndexError - индекс не входит в диапазон элементов.
* * * * KeyError - несуществующий ключ (в словаре, множестве или другом объекте). 
* * * MemoryError - недостаточно памяти.
* * * NameError - не найдено переменной с таким именем.
* * * * UnboundLocalError - сделана ссылка на локальную переменную в функции, но переменная не
определена ранее. 
* * * OSError - ошибка, связанная с системой.
* * * * BlockingIOError
* * * * ChildProcessError - неудача при операции с дочерним процессом.
* * * * ConnectionError - базовый класс для исключений, связанных с подключениями.
* * * * * BrokenPipeError
* * * * * ConnectionAbortedError
* * * * * ConnectionRefusedError
* * * * * ConnectionResetError
* * * * FileExistsError - попытка создания файла или директории, которая уже существует.
* * * * FileNotFoundError - файл или директория не существует.
* * * * InterruptedError - системный вызов прерван входящим сигналом.
* * * * IsADirectoryError - ожидался файл, но это директория.
* * * * NotADirectoryError - ожидалась директория, но это файл.
* * * * PermissionError - не хватает прав доступа.
* * * * ProcessLookupError - указанного процесса не существует.
* * * * TimeoutError - закончилось время ожидания.
* * * ReferenceError - попытка доступа к атрибуту со слабой ссылкой.
* * * RuntimeError - возникает, когда исключение не попадает ни под одну из других категорий.
* * * NotImplementedError - возникает, когда абстрактные методы класса требуют переопределения в
дочерних классах.
* * * SyntaxError - синтаксическая ошибка.
* * * * IndentationError - неправильные отступы.
* * * * * TabError - смешивание в отступах табуляции и пробелов.
* * * SystemError - внутренняя ошибка.
* * * TypeError - операция применена к объекту несоответствующего типа.
* * * ValueError - функция получает аргумент правильного типа, но некорректного значения.
* * * UnicodeError - ошибка, связанная с кодированием / раскодированием unicode в строках.
* * * * UnicodeEncodeError - исключение, связанное с кодированием unicode.
* * * * UnicodeDecodeError - исключение, связанное с декодированием unicode.
* * * * UnicodeTranslateError - исключение, связанное с переводом unicode.
* * * Warning - предупреждение.
## 4. Паттерны проектирования - общие понятия
## 5. Фабрика, Синглтон, Декоратор, Адаптер
## 6. Практическое занятие